{"version":3,"file":"index.modern.js","sources":["../src/index.js"],"sourcesContent":["import Plugin from '@swup/plugin';\nimport { classify, getCurrentUrl, matchPath, updateHistoryRecord } from 'swup';\n\nexport default class SwupRouteNamePlugin extends Plugin {\n\tname = 'SwupRouteNamePlugin';\n\n\trequires = { swup: '>=4' };\n\n\tdefaults = {\n\t\troutes: [],\n\t\tunknownRoute: 'unknown',\n\t\tmatchOptions: {},\n\t\tpaths: false\n\t};\n\n\tconstructor(options = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t\tthis.routes = this.compileRoutePatterns();\n\t}\n\n\tmount() {\n\t\t// Save route to current history record\n\t\tthis.swup.visit.to.route = this.getRouteName(getCurrentUrl());\n\t\tthis.updateHistory(this.swup.visit);\n\n\t\tthis.before('visit:start', this.addRouteKey);\n\t\tthis.on('animation:out:start', this.addPathClasses);\n\t\tthis.on('animation:out:start', this.addRouteClasses);\n\t\tthis.on('content:replace', this.updateHistory);\n\t\tthis.on('animation:in:end', this.removeClasses);\n\t}\n\n\t// Compile route patterns to match functions and valid classnames\n\tcompileRoutePatterns() {\n\t\treturn this.options.routes.map((route) => {\n\t\t\tconst name = this.sanitizeRouteName(route.name);\n\t\t\tconst matches = matchPath(route.path, this.options.matchOptions);\n\t\t\treturn { ...route, name, matches };\n\t\t});\n\t}\n\n\tsanitizeRouteName(name) {\n\t\treturn name.replace(/[!\"#$%&'()*+,./:;<=>?@[\\\\\\]^`{|}~\\s]/g, '');\n\t}\n\n\t// Get route name for any path\n\tgetRouteName(path) {\n\t\tconst { name } = this.routes.find((route) => route.matches(path)) || {};\n\t\treturn name || null;\n\t}\n\n\t// Get path name for any path\n\tgetPathName(path) {\n\t\treturn classify(path) || 'homepage';\n\t}\n\n\t// Add a `route` key to the visit object's `from` and `to` properties\n\taddRouteKey(visit) {\n\t\tif (!this.options.routes.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tvisit.from.route = this.getRouteName(visit.from.url);\n\t\tvisit.to.route = this.getRouteName(visit.to.url);\n\n\t\tthis.swup.log(\n\t\t\t`Route: '${visit.from.route || unknown || '(unknown)'}'` +\n\t\t\t\t` to '${visit.to.route || unknown || '(unknown)'}'`\n\t\t);\n\t}\n\n\t// Add `from-route-*` and `to-route-*` classnames to html tag\n\taddRouteClasses(visit) {\n\t\tif (!this.options.routes.length) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst from = visit.from.route;\n\t\tconst to = visit.to.route;\n\t\tconst unknown = this.options.unknownRoute;\n\n\t\tif (from || unknown) {\n\t\t\tdocument.documentElement.classList.add(`from-route-${from || unknown}`);\n\t\t}\n\t\tif (to || unknown) {\n\t\t\tdocument.documentElement.classList.add(`to-route-${to || unknown}`);\n\t\t}\n\t\tif (from && from === to) {\n\t\t\tdocument.documentElement.classList.add('to-same-route');\n\t\t}\n\t}\n\n\t// Add `from-*` and `to-*` classnames for slugified path\n\taddPathClasses(visit) {\n\t\tif (!this.options.paths) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst from = this.getPathName(visit.from.url);\n\t\tconst to = this.getPathName(visit.to.url);\n\n\t\tdocument.documentElement.classList.add(`from-${from}`);\n\t\tdocument.documentElement.classList.add(`to-${to}`);\n\t}\n\n\t// Remove `from-*` and `from-route-*` classnames from html tag\n\t// Note: swup removes `to-*` classnames on its own already\n\tremoveClasses = () => {\n\t\tconst htmlClasses = document.documentElement.className.split(' ');\n\t\tconst removeClasses = htmlClasses.filter((classItem) => classItem.startsWith('from-'));\n\t\tdocument.documentElement.classList.remove(...removeClasses);\n\t}\n\n\tupdateHistory(visit) {\n\t\tupdateHistoryRecord(undefined, { route: visit.to.route });\n\t}\n}\n"],"names":["SwupRouteNamePlugin","Plugin","constructor","options","super","this","name","requires","swup","defaults","routes","unknownRoute","matchOptions","paths","removeClasses","document","documentElement","className","split","filter","classItem","startsWith","classList","remove","_extends","compileRoutePatterns","mount","visit","to","route","getRouteName","getCurrentUrl","updateHistory","before","addRouteKey","on","addPathClasses","addRouteClasses","map","sanitizeRouteName","matches","matchPath","path","replace","find","getPathName","classify","length","from","url","log","unknown","add","updateHistoryRecord","undefined"],"mappings":"2VAGe,MAAyBA,UAAgBC,EAYvDC,YAAYC,EAAU,CAAA,GACrBC,QAAQC,KAZTC,KAAO,sBAEPC,KAAAA,SAAW,CAAEC,KAAM,OAAOH,KAE1BI,SAAW,CACVC,OAAQ,GACRC,aAAc,UACdC,aAAc,CAAE,EAChBC,OAAO,GAgGRC,KAAAA,cAAgB,KACf,MACMA,EADcC,SAASC,gBAAgBC,UAAUC,MAAM,KAC3BC,OAAQC,GAAcA,EAAUC,WAAW,UAC7EN,SAASC,gBAAgBM,UAAUC,UAAUT,IA9F7CT,KAAKF,QAAeqB,EAAA,CAAA,EAAAnB,KAAKI,SAAaN,GACtCE,KAAKK,OAASL,KAAKoB,sBACpB,CAEAC,QAECrB,KAAKG,KAAKmB,MAAMC,GAAGC,MAAQxB,KAAKyB,aAAaC,KAC7C1B,KAAK2B,cAAc3B,KAAKG,KAAKmB,OAE7BtB,KAAK4B,OAAO,cAAe5B,KAAK6B,aAChC7B,KAAK8B,GAAG,sBAAuB9B,KAAK+B,gBACpC/B,KAAK8B,GAAG,sBAAuB9B,KAAKgC,iBACpChC,KAAK8B,GAAG,kBAAmB9B,KAAK2B,eAChC3B,KAAK8B,GAAG,mBAAoB9B,KAAKS,cAClC,CAGAW,uBACC,OAAOpB,KAAKF,QAAQO,OAAO4B,IAAKT,GAG/BL,EAAA,CAAA,EAAYK,EAAOvB,CAAAA,KAFND,KAAKkC,kBAAkBV,EAAMvB,MAEjBkC,QADTC,EAAUZ,EAAMa,KAAMrC,KAAKF,QAAQS,gBAGrD,CAEA2B,kBAAkBjC,GACjB,OAAWA,EAACqC,QAAQ,wCAAyC,GAC9D,CAGAb,aAAaY,GACZ,MAAMpC,KAAEA,GAASD,KAAKK,OAAOkC,KAAMf,GAAUA,EAAMW,QAAQE,KAAU,GACrE,OAAWpC,GAAI,IAChB,CAGAuC,YAAYH,GACX,OAAOI,EAASJ,IAAS,UAC1B,CAGAR,YAAYP,GACNtB,KAAKF,QAAQO,OAAOqC,SAIzBpB,EAAMqB,KAAKnB,MAAQxB,KAAKyB,aAAaH,EAAMqB,KAAKC,KAChDtB,EAAMC,GAAGC,MAAQxB,KAAKyB,aAAaH,EAAMC,GAAGqB,KAE5C5C,KAAKG,KAAK0C,IACR,WAAUvB,EAAMqB,KAAKnB,OAASsB,SAAW,oBACjCxB,EAAMC,GAAGC,OAASsB,SAAW,gBAExC,CAGAd,gBAAgBV,GACf,IAAKtB,KAAKF,QAAQO,OAAOqC,OACxB,OAGD,MAAMC,EAAOrB,EAAMqB,KAAKnB,MAChBD,EAAGD,EAAMC,GAAGC,MACdsB,EAAU9C,KAAKF,QAAQQ,cAEzBqC,GAAQG,IACXpC,SAASC,gBAAgBM,UAAU8B,IAAK,cAAaJ,GAAQG,MAE1DvB,GAAMuB,IACTpC,SAASC,gBAAgBM,UAAU8B,IAAK,YAAWxB,GAAMuB,KAEtDH,GAAQA,IAASpB,GACpBb,SAASC,gBAAgBM,UAAU8B,IAAI,gBAEzC,CAGAhB,eAAeT,GACd,IAAKtB,KAAKF,QAAQU,MACjB,OAGD,MAAUmC,EAAG3C,KAAKwC,YAAYlB,EAAMqB,KAAKC,KACnCrB,EAAKvB,KAAKwC,YAAYlB,EAAMC,GAAGqB,KAErClC,SAASC,gBAAgBM,UAAU8B,IAAK,QAAOJ,KAC/CjC,SAASC,gBAAgBM,UAAU8B,IAAK,MAAKxB,IAC9C,CAUAI,cAAcL,GACb0B,OAAoBC,EAAW,CAAEzB,MAAOF,EAAMC,GAAGC,OAClD"}