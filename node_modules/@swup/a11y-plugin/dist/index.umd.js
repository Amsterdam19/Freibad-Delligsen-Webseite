!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t||self).SwupA11yPlugin=e()}(this,function(){function t(){return t=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},t.apply(this,arguments)}const e=t=>String(t).split(".").map(t=>String(parseInt(t||"0",10))).concat(["0","0"]).slice(0,3).join(".");class n{constructor(){this.isSwupPlugin=!0,this.swup=void 0,this.version=void 0,this.requires={},this.handlersToUnregister=[]}mount(){}unmount(){this.handlersToUnregister.forEach(t=>t()),this.handlersToUnregister=[]}_beforeMount(){if(!this.name)throw new Error("You must define a name of plugin when creating a class.")}_afterUnmount(){}_checkRequirements(){return"object"!=typeof this.requires||Object.entries(this.requires).forEach(([t,n])=>{if(!function(t,n,i){const o=function(t,e){var n;if("swup"===t)return null!=(n=e.version)?n:"";{var i;const n=e.findPlugin(t);return null!=(i=null==n?void 0:n.version)?i:""}}(t,i);return!!o&&((t,n)=>n.every(n=>{const[,i,o]=n.match(/^([\D]+)?(.*)$/)||[];var r,s;return((t,e)=>{const n={"":t=>0===t,">":t=>t>0,">=":t=>t>=0,"<":t=>t<0,"<=":t=>t<=0};return(n[e]||n[""])(t)})((s=o,r=e(r=t),s=e(s),r.localeCompare(s,void 0,{numeric:!0})),i||">=")}))(o,n)}(t,n=Array.isArray(n)?n:[n],this.swup)){const e=`${t} ${n.join(", ")}`;throw new Error(`Plugin version mismatch: ${this.name} requires ${e}`)}}),!0}on(t,e,n={}){var i;e=!(i=e).name.startsWith("bound ")||i.hasOwnProperty("prototype")?e.bind(this):e;const o=this.swup.hooks.on(t,e,n);return this.handlersToUnregister.push(o),o}once(e,n,i={}){return this.on(e,n,t({},i,{once:!0}))}before(e,n,i={}){return this.on(e,n,t({},i,{before:!0}))}replace(e,n,i={}){return this.on(e,n,t({},i,{replace:!0}))}off(t,e){return this.swup.hooks.off(t,e)}}var i=function(t){var e={exports:{}};return function(t){!function(e){function n(t){for(var e in t=t||{},this.settings={level:"polite",parent:"body",idPrefix:"live-region-",delay:0},t)t.hasOwnProperty(e)&&(this.settings[e]=t[e]);this.settings.parent=document.querySelector(this.settings.parent)}n.prototype.say=function(t,e){var n=this.settings.parent.querySelector('[id^="'+this.settings.idPrefix+'"]')||!1;n&&this.settings.parent.removeChild(n),e=e||this.settings.delay,this.currentRegion=document.createElement("span"),this.currentRegion.id=this.settings.idPrefix+Math.floor(1e4*Math.random());var i="assertive"!==this.settings.level?"status":"alert";return this.currentRegion.setAttribute("aria-live",this.settings.level),this.currentRegion.setAttribute("role",i),this.currentRegion.setAttribute("style","clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px"),this.settings.parent.appendChild(this.currentRegion),window.setTimeout(function(){this.currentRegion.textContent=t}.bind(this),e),this},t.exports=n}()}(e),e.exports}();return function(){if("undefined"!=typeof window&&"undefined"!=typeof document&&"undefined"!=typeof HTMLElement){var t=!1;try{var e=document.createElement("div");e.addEventListener("focus",function(t){t.preventDefault(),t.stopPropagation()},!0),e.focus(Object.defineProperty({},"preventScroll",{get:function(){if(navigator&&void 0!==navigator.userAgent&&navigator.userAgent&&navigator.userAgent.match(/Edge\/1[7-8]/))return t=!1;t=!0}}))}catch(t){}if(void 0===HTMLElement.prototype.nativeFocus&&!t){HTMLElement.prototype.nativeFocus=HTMLElement.prototype.focus;var n=function(t){for(var e=0;e<t.length;e++)t[e][0].scrollTop=t[e][1],t[e][0].scrollLeft=t[e][2];t=[]};HTMLElement.prototype.focus=function(t){if(t&&t.preventScroll){var e=function(t){for(var e=t.parentNode,n=[],i=document.scrollingElement||document.documentElement;e&&e!==i;)(e.offsetHeight<e.scrollHeight||e.offsetWidth<e.scrollWidth)&&n.push([e,e.scrollTop,e.scrollLeft]),e=e.parentNode;return n.push([e=i,e.scrollTop,e.scrollLeft]),n}(this);if("function"==typeof setTimeout){var i=this;setTimeout(function(){i.nativeFocus(),n(e)},0)}else this.nativeFocus(),n(e)}else this.nativeFocus()}}}}(),class extends n{constructor(t){void 0===t&&(t={}),super(),this.name="SwupA11yPlugin",this.requires={swup:">=4"},this.defaults={contentSelector:"main",headingSelector:"h1, h2, [role=heading]",announcementTemplate:"Navigated to: {title}",urlTemplate:"New page at {url}"},this.options=void 0,this.liveRegion=void 0,this.options={...this.defaults,...t},this.liveRegion=new i}mount(){this.on("visit:start",this.markAsBusy),this.on("visit:end",this.unmarkAsBusy),this.on("content:replace",this.announceVisit)}markAsBusy(){document.documentElement.setAttribute("aria-busy","true")}unmarkAsBusy(){document.documentElement.removeAttribute("aria-busy")}announceVisit(){requestAnimationFrame(()=>{this.announcePageName(),this.focusPageContent()})}announcePageName(){const{contentSelector:t,headingSelector:e,urlTemplate:n,announcementTemplate:i}=this.options;let o=n.replace("{url}",window.location.pathname);document.title&&(o=document.title);const r=document.querySelector(t);if(r){const t=r.querySelectorAll(e);if(t&&t.length){const[e]=t;o=e.getAttribute("aria-label")||e.textContent||o}}const s=i.replace("{title}",o.trim());this.liveRegion.say(s)}focusPageContent(){const t=document.querySelector(this.options.contentSelector);t&&(t.setAttribute("tabindex","-1"),t.focus({preventScroll:!0}))}}});
//# sourceMappingURL=index.umd.js.map
