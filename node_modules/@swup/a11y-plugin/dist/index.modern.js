import t from"@swup/plugin";import e from"on-demand-live-region";import"focus-options-polyfill";function n(){return n=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},n.apply(this,arguments)}class o extends t{constructor(t={}){super(),this.name="SwupA11yPlugin",this.requires={swup:">=4"},this.defaults={contentSelector:"main",headingSelector:"h1, h2, [role=heading]",announcementTemplate:"Navigated to: {title}",urlTemplate:"New page at {url}"},this.options=void 0,this.liveRegion=void 0,this.options=n({},this.defaults,t),this.liveRegion=new e}mount(){this.on("visit:start",this.markAsBusy),this.on("visit:end",this.unmarkAsBusy),this.on("content:replace",this.announceVisit)}markAsBusy(){document.documentElement.setAttribute("aria-busy","true")}unmarkAsBusy(){document.documentElement.removeAttribute("aria-busy")}announceVisit(){requestAnimationFrame(()=>{this.announcePageName(),this.focusPageContent()})}announcePageName(){const{contentSelector:t,headingSelector:e,urlTemplate:n,announcementTemplate:o}=this.options;let i=n.replace("{url}",window.location.pathname);document.title&&(i=document.title);const s=document.querySelector(t);if(s){const t=s.querySelectorAll(e);if(t&&t.length){const[e]=t;i=e.getAttribute("aria-label")||e.textContent||i}}const r=o.replace("{title}",i.trim());this.liveRegion.say(r)}focusPageContent(){const t=document.querySelector(this.options.contentSelector);t&&(t.setAttribute("tabindex","-1"),t.focus({preventScroll:!0}))}}export{o as default};
//# sourceMappingURL=index.modern.js.map
