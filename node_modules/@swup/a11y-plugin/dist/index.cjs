var e=require("@swup/plugin"),t=require("on-demand-live-region");function n(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}require("focus-options-polyfill");var o=/*#__PURE__*/n(e),i=/*#__PURE__*/n(t);module.exports=class extends o.default{constructor(e){void 0===e&&(e={}),super(),this.name="SwupA11yPlugin",this.requires={swup:">=4"},this.defaults={contentSelector:"main",headingSelector:"h1, h2, [role=heading]",announcementTemplate:"Navigated to: {title}",urlTemplate:"New page at {url}"},this.options=void 0,this.liveRegion=void 0,this.options={...this.defaults,...e},this.liveRegion=new i.default}mount(){this.on("visit:start",this.markAsBusy),this.on("visit:end",this.unmarkAsBusy),this.on("content:replace",this.announceVisit)}markAsBusy(){document.documentElement.setAttribute("aria-busy","true")}unmarkAsBusy(){document.documentElement.removeAttribute("aria-busy")}announceVisit(){requestAnimationFrame(()=>{this.announcePageName(),this.focusPageContent()})}announcePageName(){const{contentSelector:e,headingSelector:t,urlTemplate:n,announcementTemplate:o}=this.options;let i=n.replace("{url}",window.location.pathname);document.title&&(i=document.title);const s=document.querySelector(e);if(s){const e=s.querySelectorAll(t);if(e&&e.length){const[t]=e;i=t.getAttribute("aria-label")||t.textContent||i}}const u=o.replace("{title}",i.trim());this.liveRegion.say(u)}focusPageContent(){const e=document.querySelector(this.options.contentSelector);e&&(e.setAttribute("tabindex","-1"),e.focus({preventScroll:!0}))}};
//# sourceMappingURL=index.cjs.map
