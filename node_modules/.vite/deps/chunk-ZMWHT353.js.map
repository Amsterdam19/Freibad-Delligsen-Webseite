{
  "version": 3,
  "sources": ["../../on-demand-live-region/on-demand-live-region.js", "../../focus-options-polyfill/index.js", "../../@swup/a11y-plugin/src/index.ts"],
  "sourcesContent": ["/* global define */\n\n(function (global) {\n  'use strict'\n\n  // Constructor\n  function OnDemandLiveRegion (options) {\n    options = options || {}\n\n    // The default settings for the module.\n    this.settings = {\n      level: 'polite',\n      parent: 'body',\n      idPrefix: 'live-region-',\n      delay: 0\n    }\n\n    // Overwrite defaults where they are provided in options\n    for (var setting in options) {\n      if (options.hasOwnProperty(setting)) {\n        this.settings[setting] = options[setting]\n      }\n    }\n\n    // Cast parent as DOM node\n    this.settings.parent = document.querySelector(this.settings.parent)\n  }\n\n  // 'Say' method\n  OnDemandLiveRegion.prototype.say = function (thingToSay, delay) {\n    // Get rid of old live region if it exists\n    var oldRegion = this.settings.parent.querySelector('[id^=\"' + this.settings.idPrefix + '\"]') || false\n    if (oldRegion) {\n      this.settings.parent.removeChild(oldRegion)\n    }\n\n    // Did an override level get set?\n    delay = delay || this.settings.delay\n\n    // Create fresh live region\n    this.currentRegion = document.createElement('span')\n    this.currentRegion.id = this.settings.idPrefix + Math.floor(Math.random() * 10000)\n\n    // Determine redundant role\n    var role = this.settings.level !== 'assertive' ? 'status' : 'alert'\n\n    // Add role and aria-live attribution\n    this.currentRegion.setAttribute('aria-live', this.settings.level)\n    this.currentRegion.setAttribute('role', role)\n\n    // Hide live region element, but not from assistive technologies\n    this.currentRegion.setAttribute('style', 'clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px')\n\n    // Add live region to its designated parent\n    this.settings.parent.appendChild(this.currentRegion)\n\n    // Populate live region to trigger it\n    window.setTimeout(function () {\n      this.currentRegion.textContent = thingToSay\n    }.bind(this), delay)\n\n    return this\n  }\n\n  // Export OnDemandLiveRegion\n  if (typeof module !== 'undefined' && typeof module.exports !== 'undefined') {\n    module.exports = OnDemandLiveRegion\n  } else if (typeof define === 'function' && define.amd) {\n    define('OnDemandLiveRegion', [], function () {\n      return OnDemandLiveRegion\n    })\n  } else if (typeof global === 'object') {\n    // attach to window\n    global.OnDemandLiveRegion = OnDemandLiveRegion\n  }\n}(this))\n", "// focus - focusOptions - preventScroll polyfill\n(function() {\n  if (\n    typeof window === \"undefined\" ||\n    typeof document === \"undefined\" ||\n    typeof HTMLElement === \"undefined\"\n  ) {\n    return;\n  }\n\n  var supportsPreventScrollOption = false;\n  try {\n    var focusElem = document.createElement(\"div\");\n    focusElem.addEventListener(\n      \"focus\",\n      function(event) {\n        event.preventDefault();\n        event.stopPropagation();\n      },\n      true\n    );\n    focusElem.focus(\n      Object.defineProperty({}, \"preventScroll\", {\n        get: function() {\n          // Edge v18 gives a false positive for supporting inputs\n          if (\n            navigator &&\n            typeof navigator.userAgent !== 'undefined' &&\n            navigator.userAgent &&\n            navigator.userAgent.match(/Edge\\/1[7-8]/)) {\n              return supportsPreventScrollOption = false\n          }\n\n          supportsPreventScrollOption = true;\n        }\n      })\n    );\n  } catch (e) {}\n\n  if (\n    HTMLElement.prototype.nativeFocus === undefined &&\n    !supportsPreventScrollOption\n  ) {\n    HTMLElement.prototype.nativeFocus = HTMLElement.prototype.focus;\n\n    var calcScrollableElements = function(element) {\n      var parent = element.parentNode;\n      var scrollableElements = [];\n      var rootScrollingElement =\n        document.scrollingElement || document.documentElement;\n\n      while (parent && parent !== rootScrollingElement) {\n        if (\n          parent.offsetHeight < parent.scrollHeight ||\n          parent.offsetWidth < parent.scrollWidth\n        ) {\n          scrollableElements.push([\n            parent,\n            parent.scrollTop,\n            parent.scrollLeft\n          ]);\n        }\n        parent = parent.parentNode;\n      }\n      parent = rootScrollingElement;\n      scrollableElements.push([parent, parent.scrollTop, parent.scrollLeft]);\n\n      return scrollableElements;\n    };\n\n    var restoreScrollPosition = function(scrollableElements) {\n      for (var i = 0; i < scrollableElements.length; i++) {\n        scrollableElements[i][0].scrollTop = scrollableElements[i][1];\n        scrollableElements[i][0].scrollLeft = scrollableElements[i][2];\n      }\n      scrollableElements = [];\n    };\n\n    var patchedFocus = function(args) {\n      if (args && args.preventScroll) {\n        var evScrollableElements = calcScrollableElements(this);\n        if (typeof setTimeout === 'function') {\n          var thisElem = this;\n          setTimeout(function () {\n            thisElem.nativeFocus();\n            restoreScrollPosition(evScrollableElements);\n          }, 0);\n        } else {\n          this.nativeFocus();\n          restoreScrollPosition(evScrollableElements);\n        }\n      }\n      else {\n        this.nativeFocus();\n      }\n    };\n\n    HTMLElement.prototype.focus = patchedFocus;\n  }\n})();\n", "import Plugin from '@swup/plugin';\nimport OnDemandLiveRegion from 'on-demand-live-region';\n\nimport 'focus-options-polyfill';\n\ntype Options = {\n\t/** The selector for matching the main content area of the page. */\n\tcontentSelector: string;\n\t/** The selector for finding headings inside the main content area. */\n\theadingSelector: string;\n\t/** How to announce the new page title. */\n\tannouncementTemplate: string;\n\t/** How to announce the new page url. Used as fallback if no heading was found. */\n\turlTemplate: string;\n};\n\nexport default class SwupA11yPlugin extends Plugin {\n\tname = 'SwupA11yPlugin';\n\n\trequires = { swup: '>=4' };\n\n\tdefaults: Options = {\n\t\tcontentSelector: 'main',\n\t\theadingSelector: 'h1, h2, [role=heading]',\n\t\tannouncementTemplate: 'Navigated to: {title}',\n\t\turlTemplate: 'New page at {url}'\n\t};\n\n\toptions: Options;\n\n\tliveRegion: OnDemandLiveRegion;\n\n\tconstructor(options: Partial<Options> = {}) {\n\t\tsuper();\n\t\tthis.options = { ...this.defaults, ...options };\n\t\tthis.liveRegion = new OnDemandLiveRegion();\n\t}\n\n\tmount() {\n\t\tthis.on('visit:start', this.markAsBusy);\n\t\tthis.on('visit:end', this.unmarkAsBusy);\n\t\tthis.on('content:replace', this.announceVisit);\n\t}\n\n\tmarkAsBusy() {\n\t\tdocument.documentElement.setAttribute('aria-busy', 'true');\n\t}\n\n\tunmarkAsBusy() {\n\t\tdocument.documentElement.removeAttribute('aria-busy');\n\t}\n\n\tannounceVisit() {\n\t\trequestAnimationFrame(() => {\n\t\t\tthis.announcePageName();\n\t\t\tthis.focusPageContent();\n\t\t});\n\t}\n\n\tannouncePageName() {\n\t\tconst { contentSelector, headingSelector, urlTemplate, announcementTemplate } =\n\t\t\tthis.options;\n\n\t\t// Default: announce new /path/of/page.html\n\t\tlet pageName: string = urlTemplate.replace('{url}', window.location.pathname);\n\n\t\t// Check for title tag\n\t\tif (document.title) {\n\t\t\tpageName = document.title;\n\t\t}\n\n\t\t// Look for first heading in content container\n\t\tconst content = document.querySelector(contentSelector);\n\t\tif (content) {\n\t\t\tconst headings = content.querySelectorAll(headingSelector);\n\t\t\tif (headings && headings.length) {\n\t\t\t\tconst [heading] = headings;\n\t\t\t\tpageName = heading.getAttribute('aria-label') || heading.textContent || pageName;\n\t\t\t}\n\t\t}\n\n\t\tconst announcement = announcementTemplate.replace('{title}', pageName.trim());\n\t\tthis.liveRegion.say(announcement);\n\t}\n\n\tfocusPageContent() {\n\t\tconst content = document.querySelector<HTMLElement>(this.options.contentSelector);\n\t\tif (content) {\n\t\t\tcontent.setAttribute('tabindex', '-1');\n\t\t\tcontent.focus({ preventScroll: true });\n\t\t}\n\t}\n}\n"],
  "mappings": "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",
  "names": ["e", "SwupA11yPlugin", "Plugin", "constructor", "options", "super", "this", "name", "requires", "swup", "defaults", "contentSelector", "headingSelector", "announcementTemplate", "urlTemplate", "liveRegion", "_extends", "OnDemandLiveRegion", "mount", "on", "markAsBusy", "unmarkAsBusy", "announceVisit", "document", "documentElement", "setAttribute", "removeAttribute", "requestAnimationFrame", "announcePageName", "focusPageContent", "pageName", "replace", "window", "location", "pathname", "title", "content", "querySelector", "headings", "querySelectorAll", "length", "heading", "getAttribute", "textContent", "announcement", "trim", "say", "focus", "preventScroll"]
}
