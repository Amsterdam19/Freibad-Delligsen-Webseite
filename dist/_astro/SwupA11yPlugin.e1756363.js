import{e as h}from"./index.modern.d96712a8.js";function d(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var p={exports:{}};(function(i){(function(o){function s(n){n=n||{},this.settings={level:"polite",parent:"body",idPrefix:"live-region-",delay:0};for(var r in n)n.hasOwnProperty(r)&&(this.settings[r]=n[r]);this.settings.parent=document.querySelector(this.settings.parent)}s.prototype.say=function(n,r){var e=this.settings.parent.querySelector('[id^="'+this.settings.idPrefix+'"]')||!1;e&&this.settings.parent.removeChild(e),r=r||this.settings.delay,this.currentRegion=document.createElement("span"),this.currentRegion.id=this.settings.idPrefix+Math.floor(Math.random()*1e4);var t=this.settings.level!=="assertive"?"status":"alert";return this.currentRegion.setAttribute("aria-live",this.settings.level),this.currentRegion.setAttribute("role",t),this.currentRegion.setAttribute("style","clip: rect(1px, 1px, 1px, 1px); height: 1px; overflow: hidden; position: absolute; white-space: nowrap; width: 1px"),this.settings.parent.appendChild(this.currentRegion),window.setTimeout(function(){this.currentRegion.textContent=n}.bind(this),r),this},i.exports=s})()})(p);var f=p.exports;const g=d(f);(function(){if(!(typeof window>"u"||typeof document>"u"||typeof HTMLElement>"u")){var i=!1;try{var o=document.createElement("div");o.addEventListener("focus",function(e){e.preventDefault(),e.stopPropagation()},!0),o.focus(Object.defineProperty({},"preventScroll",{get:function(){if(navigator&&typeof navigator.userAgent<"u"&&navigator.userAgent&&navigator.userAgent.match(/Edge\/1[7-8]/))return i=!1;i=!0}}))}catch{}if(HTMLElement.prototype.nativeFocus===void 0&&!i){HTMLElement.prototype.nativeFocus=HTMLElement.prototype.focus;var s=function(e){for(var t=e.parentNode,a=[],u=document.scrollingElement||document.documentElement;t&&t!==u;)(t.offsetHeight<t.scrollHeight||t.offsetWidth<t.scrollWidth)&&a.push([t,t.scrollTop,t.scrollLeft]),t=t.parentNode;return t=u,a.push([t,t.scrollTop,t.scrollLeft]),a},n=function(e){for(var t=0;t<e.length;t++)e[t][0].scrollTop=e[t][1],e[t][0].scrollLeft=e[t][2];e=[]},r=function(e){if(e&&e.preventScroll){var t=s(this);if(typeof setTimeout=="function"){var a=this;setTimeout(function(){a.nativeFocus(),n(t)},0)}else this.nativeFocus(),n(t)}else this.nativeFocus()};HTMLElement.prototype.focus=r}}})();function c(){return c=Object.assign?Object.assign.bind():function(i){for(var o=1;o<arguments.length;o++){var s=arguments[o];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(i[n]=s[n])}return i},c.apply(this,arguments)}class v extends h{constructor(o={}){super(),this.name="SwupA11yPlugin",this.requires={swup:">=4"},this.defaults={contentSelector:"main",headingSelector:"h1, h2, [role=heading]",announcementTemplate:"Navigated to: {title}",urlTemplate:"New page at {url}"},this.options=void 0,this.liveRegion=void 0,this.options=c({},this.defaults,o),this.liveRegion=new g}mount(){this.on("visit:start",this.markAsBusy),this.on("visit:end",this.unmarkAsBusy),this.on("content:replace",this.announceVisit)}markAsBusy(){document.documentElement.setAttribute("aria-busy","true")}unmarkAsBusy(){document.documentElement.removeAttribute("aria-busy")}announceVisit(){requestAnimationFrame(()=>{this.announcePageName(),this.focusPageContent()})}announcePageName(){const{contentSelector:o,headingSelector:s,urlTemplate:n,announcementTemplate:r}=this.options;let e=n.replace("{url}",window.location.pathname);document.title&&(e=document.title);const t=document.querySelector(o);if(t){const u=t.querySelectorAll(s);if(u&&u.length){const[l]=u;e=l.getAttribute("aria-label")||l.textContent||e}}const a=r.replace("{title}",e.trim());this.liveRegion.say(a)}focusPageContent(){const o=document.querySelector(this.options.contentSelector);o&&(o.setAttribute("tabindex","-1"),o.focus({preventScroll:!0}))}}export{v as default};
